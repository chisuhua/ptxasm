.version 6.0
.target sm_50
.address_size 64

.visible .entry simple_add(.param .u64 param_a, .param .u64 param_b, .param .u64 param_c) {
    .reg .u64 %rd<4>;
    .reg .u32 %r<4>;
    .reg .pred %p<2>;

    ld.param.u64 %rd1, [param_a];
    ld.param.u64 %rd2, [param_b];
    ld.param.u64 %rd3, [param_c];

    mov.u32 %r1, %tid.x; // 使用特殊寄存器

    ld.global.u32 %r2, [%rd1 + %r1 * 4]; // 加载 a[i]
    ld.global.u32 %r3, [%rd2 + %r1 * 4]; // 加载 b[i]

    add.u32 %r4, %r2, %r3; // c[i] = a[i] + b[i]

    st.global.u32 [%rd3 + %r1 * 4], %r4; // 存储 c[i]

    ret;
}
